<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Опрос: Культура Компании (OCP)</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 2rem;
      line-height: 1.6;
    }
    label {
      display: block;
      margin-top: 1.5rem;
      font-weight: bold;
    }
    .question {
      margin-bottom: 1.2rem;
    }
    .slider-label {
      margin-top: 0.25rem;
      font-weight: normal;
    }
    input[type="range"] {
      width: 100%;
    }
    input[name$="_current"]::-webkit-slider-thumb {
      background: #007bff;
    }
    input[name$="_desired"]::-webkit-slider-thumb {
      background: #28a745;
    }
    .range-values {
      display: flex;
      justify-content: space-between;
      font-size: 0.8rem;
      color: #777;
    }
    .submit-button {
      margin-top: 2rem;
      padding: 0.75rem 1.5rem;
      background-color: #007bff;
      color: #fff;
      border: none;
      font-size: 1rem;
      cursor: pointer;
    }
  </style>
</head>
<body>
  <h1>Опрос по Корпоративной Культуре (OCP)</h1>
  <p>
    Оцените каждое утверждение дважды: насколько оно <strong>соответствует текущей культуре</strong> вашей компании и насколько оно <strong>важно для будущей культуры</strong>.<br>
    <strong>1 = Совершенно не соответствует | 7 = Полностью соответствует</strong>
  </p>

  <form id="ocpForm">
    <label for="name">Ваше имя (необязательно):</label>
    <input type="text" name="respondent" placeholder="Иван Иванов">
    <div id="questions"></div>
    <button type="submit" class="submit-button">Отправить</button>
  </form>

  <script>
    const questions = [
      "Ориентированность на результат", "Высокие ожидания от производительности", "Лёгкость в общении",
      "Стремление к достижениям", "Спокойствие", "Ориентация на действия", "Внимание к деталям",
      "Точность", "Качество как приоритет", "Аналитический подход", "Ориентация на клиента",
      "Умение слушать клиента", "Ориентация на рынок", "Нравственные принципы", "Высокие этические стандарты",
      "Честность", "Открытое распространение информации", "Прозрачность личных целей",
      "Поставить цели организации выше личных", "Готовность к риску", "Осторожность", "Предсказуемость",
      "Готовность к экспериментам", "Инновационность", "Быстрота", "Умение воспользоваться возможностями",
      "Инициативность", "Выполнение KPI", "Избегание конфликтов", "Совместная работа",
      "Командная работа", "Агрессивность", "Высокий уровень конфликтов", "Кооперативность",
      "Обучение на ошибках", "Поддержка коллег", "Соревновательность", "Ориентация на людей",
      "Уважение к личности", "Инвестирование в развитие сотрудников", "Поддержка карьерных целей",
      "Ответственность как у владельца", "Личная ответственность", "Знания важнее связей",
      "Гарантии занятости", "Минимум ограничений и правил", "Следование правилам",
      "Прямое разрешение конфликтов", "Решительность", "Толерантность", "Профессиональный рост",
      "Срочность", "Стабильность"
    ];

    const container = document.getElementById("questions");
    function getDescription(index) {
      const descriptions = [
        "Фокус на конкретных, измеримых результатах и достижении целей.",
        "Ожидание высокого уровня производительности от всех сотрудников.",
        "Неформальная атмосфера, непринуждённое поведение.",
        "Настрой на достижения, постоянное стремление к успеху.",
        "Спокойствие и уравновешенность в работе.",
        "Быстрое принятие решений и действий, ориентация на реализацию.",
        "Тщательное внимание к деталям и точность.",
        "Фокус на точности в работе и аккуратности.",
        "Поддержание высокого качества в продуктах и услугах.",
        "Использование логики и аналитики при принятии решений.",
        "Ориентация на клиента как основу стратегии компании.",
        "Готовность выслушать клиентов и учитывать их мнение.",
        "Понимание рыночных тенденций и потребностей.",
        "Демонстрация честности и моральных принципов.",
        "Ориентация на высокие этические стандарты поведения.",
        "Честность как норма повседневной работы.",
        "Свободный обмен информацией между подразделениями.",
        "Прозрачность индивидуальных целей и задач.",
        "Предпочтение интересов всей компании над интересами отдела.",
        "Готовность рисковать ради новых идей и решений.",
        "Осторожность и стремление избегать ошибок.",
        "Предсказуемость и стабильность в поведении.",
        "Готовность пробовать новое и экспериментировать.",
        "Стремление к инновациям и нестандартным подходам.",
        "Быстрое реагирование на изменения и вызовы.",
        "Умение использовать новые возможности раньше других.",
        "Инициативность и самозапуск, работа без напоминаний.",
        "Фокус на достижении KPI и количественных целей.",
        "Избежание прямых конфликтов и напряжений.",
        "Совместная работа с другими для достижения результата.",
        "Командная работа и взаимопомощь.",
        "Агрессивность в коммуникации и продвижении идей.",
        "Конфликты и разногласия в коллективе.",
        "Кооперация и готовность сотрудничать.",
        "Извлечение уроков из ошибок.",
        "Поддержка коллег и позитивная атмосфера.",
        "Соревновательность и стремление к лидерству.",
        "Забота о людях как ценности компании.",
        "Уважительное отношение к личности каждого.",
        "Инвестирование в развитие и обучение сотрудников.",
        "Поддержка карьерных целей и роста.",
        "Ответственность, как у владельца компании.",
        "Принятие личной ответственности за результаты.",
        "Знания важнее связей при принятии решений.",
        "Безопасность занятости как приоритет.",
        "Минимум ограничений и правил.",
        "Следование правилам и стандартам.",
        "Открытое обсуждение и разрешение конфликтов.",
        "Умение быстро принимать решения.",
        "Толерантность к различным мнениям и подходам.",
        "Фокус на профессиональном развитии.",
        "Чувство срочности и быстрое выполнение задач.",
        "Стабильность и предсказуемость бизнес-процессов."
      ];
      return descriptions[index - 1] || "";
    }
    const dimensions = [
      "Ориентация на результат и выполнение", // 1-2
      "Инновации и адаптивность", // 3-6
      "Внимание к качеству и деталям", // 7-10
      "Клиентоориентированность", // 11-13
      "Этика и открытость", // 14-19
      "Риск и экспериментальность", // 20-26
      "Взаимодействие и командность", // 27-34
      "Ориентация на людей и развитие" // 35-54
    ];

    questions.forEach((q, i) => {
      const index = i + 1;
      if ([0, 2, 6, 10, 13, 19, 26, 34].includes(i)) {
        const blockIndex = [0, 2, 6, 10, 13, 19, 26, 34].indexOf(i);
        container.innerHTML += `<h3 style='margin-top:2rem;'>${dimensions[blockIndex]}</h3>`;
      }
      container.innerHTML += `
        <div class=\"question\">
          <label>\${index}. \${q}</label>
          <div style='font-size: 0.9rem; font-style: italic; color: #555;'>\${getDescription(index)}</div>`;
          <span class="slider-label">Текущая культура</span>
          <input type="range" name="q${index}_current" min="1" max="7">
          <div class="range-values"><span>1</span><span>2</span><span>3</span><span>4</span><span>5</span><span>6</span><span>7</span></div>
          <span class="slider-label">Желаемая культура</span>
          <input type="range" name="q${index}_desired" min="1" max="7">
          <div class="range-values"><span>1</span><span>2</span><span>3</span><span>4</span><span>5</span><span>6</span><span>7</span></div>
        </div>
      `;
    });

    document.getElementById("ocpForm").addEventListener("submit", async function (e) {
      e.preventDefault();
      const formData = new FormData(e.target);
      const data = {};
      formData.forEach((value, key) => {
        data[key] = value;
      });

      try {
        await fetch("https://script.google.com/macros/s/AKfycby95e1NuEIKxgB_zBl63WMEULtpEN4Ii2s64c0THW3v4qA9DJNyM8VUn8iehbsTXA7GCQ/exec", {
          method: "POST",
          mode: "no-cors",
          headers: {
            "Content-Type": "application/json"
          },
          body: JSON.stringify(data)
        });
        alert("Спасибо! Ваши ответы отправлены.");
        e.target.reset();
      } catch (error) {
        alert("Произошла ошибка при отправке данных.");
      }
    });
  </script>
</body>
</html>
